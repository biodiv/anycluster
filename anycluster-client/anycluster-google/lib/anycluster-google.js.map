{"mappings":"AGCA,IAOO;UAAK,KAAK;IAAL,MACR,cAAW;IADH,MAER,cAAW;GAFH,8CAAA;IAKL;UAAK,aAAa;IAAb,cACR,YAAA;IADQ,cAER,UAAA;GAFQ,8CAAA;IAML;UAAK,YAAY;IAAZ,aACR,cAAA;IADQ,aAER,UAAA;GAFQ,8CAAA;IAKL;UAAK,QAAQ;IAAR,SACR,WAAA;IADQ,SAER,aAAA;GAFQ,8CAAA;IAKL;UAAK,gBAAgB;IAAhB,iBAAA,iBACR,UAAO,MAAP;IADQ,iBAAA,iBAER,YAAS,OAAT;GAFQ,6CAAA;AAKL,MAAM,4CAA0B;IACnC,GAAG;QAAC;QAAI;KAAG;IACX,GAAG;QAAC;QAAI;KAAG;IACX,IAAI;QAAC;QAAI;KAAG;IACZ,IAAI;QAAC;QAAI;KAAG;IACZ,KAAK;QAAC;QAAI;KAAG;IACb,MAAM;QAAC;QAAI;KAAG;IACd,OAAO;QAAC;QAAI;KAAG;AACnB;IAEO;UAAK,SAAS;IAAT,UACR,QAAA;IADQ,UAER,WAAQ;IAFA,UAGR,YAAS;IAHD,UAIR,cAAW;IAJH,UAKR,gBAAa;IALL,UAMR,iBAAc;IANN,UAOR,gBAAA;IAPQ,UAQR,cAAA;GARQ,8CAAA;;AD5CZ;AEAA;AAGO,MAAM,4CAAwB,OAAO,MAAM,CAAC;IAC/C,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;AACV;AAGO,MAAM,4CAAwB,OAAO,MAAM,CAAC;IAC/C,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM,SAAS,cAAc;AACjC;AA2BO,MAAM;IAIT,YAAoB,QAAuB,UAAyB,KAAa;sBAA7D;wBAAuB;oBAAyB;QAEhE,IAAI,IAAI,CAAC,IAAI,IAAI,CAAA,GAAA,yCAAK,AAAD,EAAE,QAAQ,EAC3B,IAAI,CAAC,SAAS,GAAG;aAEhB,IAAI,IAAI,CAAC,IAAI,IAAI,CAAA,GAAA,yCAAK,AAAD,EAAE,QAAQ,EAChC,IAAI,CAAC,SAAS,GAAG;aAGjB,MAAM,IAAI,MAAM,CAAC,oBAAoB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE;IAG7D;IAEA,MAAM,eAAe,IAAY,EAAE,IAAwB,EAAE;QACzD,MAAM,MAAM,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC1D,MAAM,WAAW,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK;QACtC,OAAO;IACX;IAEA,MAAM,iBAAiB,IAAY,EAAE,IAAwB,EAAE;QAE3D,MAAM,MAAM,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,KAAK,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC5D,MAAM,WAAW,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK;QACtC,OAAO;IACX;IAEA,MAAM,wBAAwB,IAAY,EAAE,IAAwC,EAAE;QAElF,MAAM,MAAM,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,2BAA2B,EAAE,KAAK,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;QAEhF,MAAM,iBAAiB,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK;QAE5C,OAAO;IACX;IAEA,MAAM,kBAAkB,IAAY,EAAE,SAAiB,EAAE;QACrD,MAAM,MAAM,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,KAAK,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;QAEtF,MAAM,iBAAiB,MAAM,IAAI,CAAC,GAAG,CAAC;QAEtC,OAAO;IACX;IAEA,iBAAiB,CAEjB;IAEA,kBAAkB,QAAkB,EAAE;QAElC,MAAM,OAAO,KAAK,GAAG,CAAC,SAAS,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;QACxD,MAAM,QAAQ,KAAK,GAAG,CAAC,SAAS,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;QAC1D,MAAM,MAAM,KAAK,GAAG,CAAC,SAAS,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;QACtD,MAAM,SAAS,KAAK,GAAG,CAAC,SAAS,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI;QAE5D,MAAM,eAAe;QAErB,MAAM,cAAc;YAAC;gBACjB;oBAAC;oBAAM;iBAAI;gBACX;oBAAC;oBAAO;iBAAI;gBACZ;oBAAC;oBAAO;iBAAO;gBACf;oBAAC;oBAAM;iBAAO;gBACd;oBAAC;oBAAM;iBAAI;aACd;SAAC;QAEF,MAAM,UAAU;YACZ,QAAQ;YACR,YAAY;gBACR,QAAQ;gBACR,eAAe;gBACf,OAAO;oBACH,QAAQ;oBACR,cAAc;wBACV,QAAQ,IAAI,CAAC,IAAI;oBACrB;gBACJ;YACJ;QACJ;QAEA,OAAO;IACX;IAEA,MAAM,KAAK,GAAW,EAAE,QAAgB,EAAE;QAEtC,MAAM,aAAa,UAAU;QAE7B,MAAM,UAAU;YACZ,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;YACrB,SAAS;gBACL,gBAAgB;YACpB;YACA,MAAM;YACN,aAAa;QACjB;QAEA,MAAM,WAAW,MAAM,MAAM,YAAY;QACzC,MAAM,eAAe,MAAM,SAAS,IAAI;QAExC,IAAI,SAAS,EAAE,EACX,OAAO;aAGP,MAAM,IAAI,MAAM,KAAK,SAAS,CAAC,eAAe;IAGtD;IAEA,MAAM,IAAI,GAAW,EAAE;QACnB,MAAM,aAAa,UAAU;QAE7B,MAAM,UAAU;YACZ,QAAQ;YACR,SAAS;gBACL,gBAAgB;YACpB;YACA,MAAM;YACN,aAAa;QACjB;QAEA,MAAM,WAAW,MAAM,MAAM,YAAY;QACzC,MAAM,eAAe,MAAM,SAAS,IAAI;QAExC,IAAI,SAAS,EAAE,EACX,OAAO;aAGP,MAAM,IAAI,MAAM,KAAK,SAAS,CAAC,eAAe;IAEtD;AACJ;;;AChLA;;AAKA,MAAM,8CAAwB;IAC1B,GAAG;IACH,IAAI;IACJ,IAAI;IACJ,KAAK;IACL,MAAM;IACN,OAAO;AACX;AAEA,MAAM,gDAA0B;IAC5B,GAAG;IACH,IAAI;IACJ,IAAI;IACJ,KAAK;IACL,MAAM;IACN,OAAO;AACX;AAiBO,MAAM;IAwBT,YAAmB,KAAiB,QAAuB,kBAA0B,QAAkC,CAAE;mBAAtG;sBAAiB;gCAAuB;aAH3D,UAAsB,EAAE;QAKpB,IAAI,CAAC,GAAG,GAAG;QACX,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,gBAAgB,GAAG;QAExB,WAAW,YAAY,CAAC;QAGxB,WAAW;QACX,IAAI,CAAC,IAAI,GAAG,SAAS,IAAI,GAAG,SAAS,IAAI,GAAG,CAAA,GAAA,yCAAK,AAAD,EAAE,QAAQ;QAC1D,IAAI,CAAC,cAAc,GAAG,SAAS,YAAY,GAAG,SAAS,YAAY,GAAG,CAAA,GAAA,wCAAgB,AAAD,EAAE,MAAM;QAC7F,IAAI,CAAC,YAAY,GAAG,SAAS,YAAY,GAAG,SAAS,YAAY,GAAG,CAAA,GAAA,wCAAgB,AAAD,EAAE,IAAI;QAEzF,IAAI,CAAC,aAAa,GAAG,SAAS,aAAa,GAAG,SAAS,aAAa,GAAG,CAAA,GAAA,yCAAa,AAAD,EAAE,MAAM;QAC3F,IAAI,CAAC,YAAY,GAAG,SAAS,YAAY,GAAG,SAAS,YAAY,GAAG,CAAA,GAAA,yCAAY,AAAD,EAAE,QAAQ;QAEzF,IAAI,CAAC,IAAI,GAAG,SAAS,IAAI,GAAG,SAAS,IAAI,GAAG,IAAI;QAChD,IAAI,CAAC,QAAQ,GAAG,SAAS,QAAQ,GAAG,SAAS,QAAQ,GAAG,CAAA,GAAA,yCAAQ,AAAD,EAAE,OAAO;QAExE,IAAI,CAAC,YAAY,GAAG,SAAS,YAAY,GAAG,SAAS,YAAY,GAAG,IAAI,CAAC,aAAa;QAEtF,IAAI,CAAC,eAAe,GAAG,SAAS,eAAe,GAAG,SAAS,eAAe,GAAG,CAAC,CAAC;QAE/E,IAAI,CAAC,gBAAgB,GAAG,SAAS,gBAAgB,GAAG,SAAS,gBAAgB,GAAG,CAAA,GAAA,yCAAsB,CAAC;QAEvG,IAAI,CAAC,cAAc,GAAG,SAAS,cAAc,GAAG,SAAS,cAAc,GAAG,2CAAqB;QAC/F,IAAI,CAAC,gBAAgB,GAAG,SAAS,gBAAgB,GAAG,SAAS,gBAAgB,GAAG,6CAAuB;QAGvG,IAAI,IAAI,CAAC,IAAI,EACT,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI;QAG1B,MAAM,WAAW,IAAI,CAAC,WAAW;QACjC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAA,GAAA,yCAAS,EAAE,IAAI,CAAC,MAAM,EAAE,UAAU,IAAI,CAAC,IAAI;QAEjE,IAAI,CAAC,mBAAmB;QACxB,IAAI,CAAC,UAAU,GAAG,EAAE;QAEpB,IAAI,CAAC,eAAe;IACxB;IAEA,sBAA4B;QACxB,MAAM,IAAI,MAAM,4CAA4C;IAChE;IAEA,QAAQ,OAAe,EAAQ;QAC3B,MAAM,IAAI,MAAM,gCAAgC;IACpD;IAEA,aAAmB;QACf,MAAM,IAAI,MAAM,mCAAmC;IACvD;IAEA,mBAAyB;QACrB,MAAM,IAAI,MAAM,yCAAyC;IAC7D;IAEA,UAAkB;QACd,MAAM,IAAI,MAAM,gCAAgC;IACpD;IAEA,OAAO,CAAS,EAAE,CAAS,EAAE,IAAY,EAAQ;QAC7C,MAAM,IAAI,MAAM,+BAA+B;IACnD;IAEA,cAAwB;QACpB,MAAM,IAAI,MAAM,+BAA+B;IACnD;IAEA,uBAA6B;QACzB,MAAM,IAAI,MAAM,6CAA6C;IACjE;IAEA,WAAW,OAAgB,EAAQ;QAC/B,MAAM,IAAI,MAAM,mCAAmC;IACvD;IAEA,SAAS,OAAgB,EAAQ;QAC7B,MAAM,IAAI,MAAM,iCAAiC;IACrD;IAEA,eAAe,OAAgB,EAAQ;QACnC,MAAM,IAAI,MAAM,uCAAuC;IAC3D;IAGA,cAAsB;QAClB,IAAI,IAAI,CAAC,aAAa,IAAI,CAAA,GAAA,yCAAa,AAAD,EAAE,IAAI,EACxC,OAAO,IAAI,CAAC,YAAY;QAG5B,OAAO,IAAI,CAAC,cAAc;IAC9B;IAEA,iBAAiB,aAA4B,EAAE;QAE3C,IAAI,iBAAiB,CAAA,GAAA,yCAAa,AAAD,EAAE,IAAI,EAAE;YACrC,IAAI,CAAC,IAAI,GAAG,IAAI;YAChB,IAAI,CAAC,YAAY,GAAG,CAAA,GAAA,yCAAW,EAAE,QAAQ;YACzC,IAAI,CAAC,UAAU;QACnB,CAAC;QAED,IAAI,CAAC,gBAAgB;QACrB,IAAI,CAAC,aAAa,GAAG;QACrB,MAAM,WAAW,IAAI,CAAC,WAAW;QACjC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAA,GAAA,yCAAS,EAAE,IAAI,CAAC,MAAM,EAAE,UAAU,IAAI,CAAC,IAAI;QACjE,IAAI,CAAC,UAAU,GAAG,EAAE;QACpB,IAAI,CAAC,WAAW,CAAC,IAAI;IACzB;IAEA,QAAQ,OAAgB,EAAE;QAEtB,IAAI,CAAC,IAAI,GAAG;QAEZ,IAAI,CAAC,UAAU;QAEf,IAAI,WAAW,IAAI,EAAE;YACjB,IAAI,CAAC,YAAY,GAAG,CAAA,GAAA,yCAAW,EAAE,QAAQ;YACzC,IAAI,CAAC,gBAAgB,CAAC,CAAA,GAAA,yCAAY,EAAE,MAAM;QAC9C,OACK;YAED,IAAI,CAAC,OAAO,CAAC;YAEb,IAAI,CAAC,YAAY,GAAG,CAAA,GAAA,yCAAW,EAAE,IAAI;YAErC,IAAI,CAAC,gBAAgB,CAAC,CAAA,GAAA,yCAAY,EAAE,MAAM;QAC9C,CAAC;IACL;IAEA,qBAAqB,OAAgB,EAAE;QAEnC,MAAM,SAAS,QAAQ,MAAM;QAE7B,IAAI,MAAM,CAAC,EAAE,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC;QAEnD,IAAI,IAAI,CAAC,eAAe,IAAI,UAAU,UAAU,IAAI,CAAC,eAAe,EAChE,MAAM,IAAI,CAAC,eAAe,CAAC,OAAO;QAGtC,OAAO;IAEX;IAEA,cAAc,OAAgB,EAAE;QAE5B,MAAM,QAAQ,QAAQ,KAAK;QAE3B,IAAI,iBAAiB,IAAI,CAAC,oBAAoB,CAAC;QAC/C,IAAI,UAAU;QAEd,IAAI,QAAQ,OACR,UAAU;aAGT,IAAI,QAAQ,MACb,UAAU;aAGT,IAAI,QAAQ,KACb,UAAU;aAGT,IAAI,QAAQ,IACb,UAAU;aAGT,IAAI,QAAQ,IACb,UAAU;aAGT,IAAI,QAAQ,GACb,UAAU;QAGd,IAAI,QAAQ;YACR,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAA,GAAA,yCAAO,EAAE,KAAK,EAC/B,iBAAiB,CAAC,EAAE,IAAI,CAAC,gBAAgB,CAAC,EAAE,QAAQ,UAAU,CAAC;iBAG/D,iBAAiB,CAAC,EAAE,IAAI,CAAC,gBAAgB,CAAC,EAAE,QAAQ,IAAI,CAAC;SAEhE;QAED,MAAM,OAAO,IAAI,CAAC,gBAAgB,CAAC,QAAQ;QAC3C,IAAI,SAAS;YAAC,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG;YAAI,IAAI,CAAC,EAAE,GAAG;SAAE;QACnD,IAAI,iBAAiB;YAAC;YAAK;SAAE;QAE7B,IAAI,QAAQ,GAAG;YACX,SAAS;gBAAC,KAAK,KAAK,CAAE,IAAI,CAAC,EAAE,GAAG;gBAAK,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG;aAAG;YAC7D,iBAAiB;gBAAC;gBAAK;aAAI;QAC/B,CAAC;QAED,MAAM,SAAS;YACX,KAAK;YACL,MAAM;YACN,QAAQ;YACR,gBAAgB;YAChB,aAAa;gBAAC;gBAAG,CAAC,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI;aAAE;QAC9C;QAEA,OAAO;IAEX;IAEA,oDAAoD;IACpD,eAAe,MAAW,EAAE,OAAgB,EAAE;QAE1C,wCAAwC;QACxC,OAAO,CAAC,GAAG,QAAQ,MAAM,CAAC,CAAC;QAC3B,OAAO,CAAC,GAAG,QAAQ,MAAM,CAAC,CAAC;QAC3B,OAAO,KAAK,GAAG,QAAQ,KAAK;QAE5B,IAAI,QAAQ,cAAc,CAAC,QACvB,OAAO,GAAG,GAAG,QAAQ,GAAG;QAG5B,IAAI,QAAQ,cAAc,CAAC,OACvB,OAAO,EAAE,GAAG,QAAQ,EAAE;QAG1B,IAAI,QAAQ,cAAc,CAAC,YAEvB;;;;;;;;;;;;;cAaE,GAEF,OAAO,OAAO,GAAG,QAAQ,OAAO;QAGpC,OAAO;IAEX;IAEA,oBAAoB,CAAS,EAAE,CAAS,EAAE;QACtC,IAAI,CAAC,gBAAgB;QACrB,IAAI,OAAO,IAAI,CAAC,OAAO;QACvB,OAAO,OAAO;QACd,IAAI,CAAC,MAAM,CAAC,GAAG,GAAG;IACtB;IAEA,MAAM,mBAAmB,MAAW,EAAE;QAElC,MAAM,OAAO,IAAI,CAAC,OAAO;QACzB,MAAM,IAAI,OAAO,CAAC;QAClB,MAAM,IAAI,OAAO,CAAC;QAClB,MAAM,MAAM,OAAO,GAAG;QAEtB,IAAI,IAAI,CAAC,aAAa,IAAI,CAAA,GAAA,yCAAa,AAAD,EAAE,MAAM,EAAE;YAE5C,MAAM,WAAW;gBACb,iBAAiB,IAAI,CAAC,YAAY;gBAClC,cAAc,IAAI,CAAC,IAAI;gBACvB,KAAK;gBACL,KAAK;gBACL,OAAO;gBACP,WAAW,IAAI,CAAC,OAAO;YAC3B;YAEA,MAAM,OAAO,MAAM,IAAI,CAAC,UAAU,CAAC,uBAAuB,CAAC,MAAM;YAEjE,IAAI,CAAC,YAAY,CAAC,QAAQ;QAE9B,OACK,IAAI,IAAI,CAAC,aAAa,GAAG,CAAA,GAAA,yCAAY,EAAE,IAAI;YAE5C,IAAI,OAAO,KAAK,IAAI,GAAG;gBACnB,MAAM,OAAO,MAAM,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,MAAM,OAAO,EAAE;gBACpE,IAAI,CAAC,YAAY,CAAC,QAAQ;YAC9B,OACK;gBACD,MAAM,UAAU,MAAM,CAAC,UAAU;gBACjC,MAAM,OAAO,MAAM,IAAI,CAAC,cAAc,CAAC;gBAEvC,IAAI,CAAC,YAAY,CAAC,QAAQ;YAC9B,CAAC;SAEJ;IACL;IAEA,iBAAiB,KAAa,EAAU;QAEpC,IAAI,SAAS,GACT,QAAQ;aAEP,IAAI,SAAS,GACd,QAAQ;aAEP,IAAI,SAAS,IACd,QAAQ;aAEP,IAAI,SAAS,IACd,QAAQ;aAEP,IAAI,SAAS,KACd,QAAQ;aAEP,IAAI,SAAS,MACd,QAAQ;aAGR,QAAQ;QAGZ,OAAO;IACX;IAEA,qBAAqB;QACjB,IAAI;QAEJ,IAAI,IAAI,CAAC,YAAY,IAAI,CAAA,GAAA,yCAAY,AAAD,EAAE,QAAQ,EAAE;YAC5C,MAAM,WAAW,IAAI,CAAC,WAAW;YACjC,UAAU,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC;QAChD,OACK,IAAI,IAAI,CAAC,YAAY,IAAI,CAAA,GAAA,yCAAW,EAAE,IAAI,IAAI,IAAI,CAAC,IAAI,EACxD,UAAU,IAAI,CAAC,IAAI;aAGnB,MAAM,IAAI,MAAM,6BAA6B;QAGjD,OAAO;IAEX;IAEA,MAAM,YAAY,aAAa,KAAK,EAAE;QAElC,MAAM,UAAU,IAAI,CAAC,kBAAkB;QAEvC,MAAM,WAAW;YACb,eAAe,IAAI,CAAC,IAAI;YACxB,iBAAiB,IAAI,CAAC,YAAY;YAClC,WAAW;YACX,eAAe;YACf,WAAW,IAAI,CAAC,OAAO;QAC3B;QAEA,MAAM,OAAO,IAAI,CAAC,OAAO;QAEzB,IAAI,IAAI,CAAC,aAAa,IAAI,CAAA,GAAA,yCAAa,AAAD,EAAE,MAAM,EAAE;YAG5C,MAAM,WAAsB,MAAM,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,MAAM;YAEzE,IAAI,SAAS,MAAM,GAAG,GAClB,SAAS,OAAO,CAAC,CAAA,UAAW;gBACxB,IAAI,CAAC,UAAU,CAAC;YACpB;QAER,OACK,IAAI,IAAI,CAAC,aAAa,IAAI,CAAA,GAAA,yCAAa,AAAD,EAAE,IAAI,EAAE;YAC/C,MAAM,WAAsB,MAAM,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM;YAEvE,IAAI,SAAS,MAAM,GAAG,GAClB,SAAS,OAAO,CAAC,CAAA,UAAW;gBACxB,IAAI,CAAC,QAAQ,CAAC;YAClB;QAER,OAEI,MAAM,IAAI,MAAM,CAAC,uBAAuB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,EAAE;IAExE;IAEA,kBAAkB;QACd,IAAI,CAAC,WAAW,CAAC,IAAI;QACrB,IAAI,CAAC,oBAAoB;IAC7B;IAEA,cAAc,MAAc,EAAE,IAAS,EAAE;QACrC,MAAM,KAAK,SAAS,CAAC;IACzB;IAEA,gBAAgB,OAAe,EAAE,OAAe,EAAW;QACvD,IAAI,QAAQ,MAAM,IAAI,QAAQ,MAAM,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,IAAI,QAAQ,QAAQ,IAAI,QAAQ,QAAQ,EAC1G,OAAO,IAAI;QAGf,OAAO,KAAK;IAChB;IAEA,YAAY;IACZ,OAAO,MAAc,EAAE,aAAuB,EAAE;QAC5C,IAAI,CAAC,OAAO,GAAG;YAAC;SAAO;QACvB,IAAI,CAAC,gBAAgB,CAAC;IAC1B;IAEA,UAAU,MAAc,EAAE,aAAuB,EAAE;QAE/C,IAAI,eAAe,KAAK;QAExB,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,IAAK;YAC1C,IAAI,iBAAiB,IAAI,CAAC,OAAO,CAAC,EAAE;YAEpC,IAAI,IAAI,CAAC,eAAe,CAAC,QAAQ,iBAAiB;gBAC9C,eAAe,IAAI;gBACnB,KAAM;YACV,CAAC;QAEL;QAEA,IAAI,CAAC,cACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;QAGtB,IAAI,CAAC,gBAAgB,CAAC;IAC1B;IAEA,WAAW,YAAwB,EAAE,aAAuB,EAAE;QAE1D,IAAK,IAAI,KAAK,GAAG,KAAK,aAAa,MAAM,EAAE,KAAM;YAC7C,IAAI,SAAS,YAAY,CAAC,GAAG;YAC7B,IAAI,CAAC,SAAS,CAAC,QAAQ,KAAK;QAChC;QACA,IAAI,CAAC,gBAAgB,CAAC;IAC1B;IAEA,aAAa,MAAc,EAAE,aAAuB,EAAE;QAElD,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,IAAK;YAC1C,IAAI,iBAAiB,IAAI,CAAC,OAAO,CAAC,EAAE;YAEpC,IAAI,IAAI,CAAC,eAAe,CAAC,QAAQ,iBAAiB;gBAC9C,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG;gBACvB,KAAM;YACV,CAAC;QACL;QACA,IAAI,CAAC,gBAAgB,CAAC;IAC1B;IAEA,cAAc,eAA2B,EAAE,aAAuB,EAAE;QAEhE,IAAK,IAAI,KAAK,GAAG,KAAK,gBAAgB,MAAM,EAAE,KAAM;YAEhD,IAAI,SAAS,eAAe,CAAC,GAAG;YAEhC,IAAI,CAAC,YAAY,CAAC,QAAQ,KAAK;QACnC;QAEA,IAAI,CAAC,gBAAgB,CAAC;IAC1B;IAEA,aAAa,aAAuB,EAAE;QAClC,IAAI,CAAC,OAAO,GAAG,EAAE;QACjB,IAAI,CAAC,gBAAgB,CAAC;IAC1B;IAEA,iBAAiB,aAAuB,EAAE;QACtC,IAAI,iBAAiB,KAAK,EACtB,gBAAgB,IAAI;QAExB,IAAI,iBAAiB,IAAI,EAAE;YACvB,IAAI,CAAC,gBAAgB;YACrB,IAAI,CAAC,WAAW,CAAC,IAAI;QACzB,CAAC;IACL;AAEJ;;;;AJrhBA;AMEA,sDAAA;AAIA,IAAA,sCAAiB,SAAS,MAAM,CAAC,EAAE,CAAC,EAAE;IACpC,IAAI,MAAM,GAAG,OAAO,IAAI;IAExB,IAAI,KAAK,KAAK,OAAO,KAAK,YAAY,OAAO,KAAK,UAAU;QAC1D,IAAI,EAAE,WAAW,KAAK,EAAE,WAAW,EAAE,OAAO,KAAK;QAEjD,IAAI,QAAQ,GAAG;QACf,IAAI,MAAM,OAAO,CAAC,IAAI;YACpB,SAAS,EAAE,MAAM;YACjB,IAAI,UAAU,EAAE,MAAM,EAAE,OAAO,KAAK;YACpC,IAAK,IAAI,QAAQ,QAAQ,GACvB,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,OAAO,KAAK;YACtC,OAAO,IAAI;QACjB,CAAK;QAID,IAAI,EAAE,WAAW,KAAK,QAAQ,OAAO,EAAE,MAAM,KAAK,EAAE,MAAM,IAAI,EAAE,KAAK,KAAK,EAAE,KAAK;QACjF,IAAI,EAAE,OAAO,KAAK,OAAO,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,OAAO,EAAE,OAAO;QAC5E,IAAI,EAAE,QAAQ,KAAK,OAAO,SAAS,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ,OAAO,EAAE,QAAQ;QAEhF,OAAO,OAAO,IAAI,CAAC;QACnB,SAAS,KAAK,MAAM;QACpB,IAAI,WAAW,OAAO,IAAI,CAAC,GAAG,MAAM,EAAE,OAAO,KAAK;QAElD,IAAK,IAAI,QAAQ,QAAQ,GACvB,IAAI,CAAC,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,OAAO,KAAK;QAErE,IAAK,IAAI,QAAQ,QAAQ,GAAI;YAC3B,IAAI,MAAM,IAAI,CAAC,EAAE;YAEjB,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,GAAG,OAAO,KAAK;QAC9C;QAEI,OAAO,IAAI;IACf,CAAG;IAEH,oCAAA;IACE,OAAO,MAAI,KAAK,MAAI;AACtB;AC7CA;;;;;;;;;;;;;;CAcG,GAaI,MAAM,4CAAa;AA0J1B;;CAEG,GACS,IAAA;AAAZ,CAAA,SAAY,YAAY,EAAA;IACtB,YAAA,CAAA,YAAA,CAAA,cAAA,GAAA,EAAA,GAAA;IACA,YAAA,CAAA,YAAA,CAAA,UAAA,GAAA,EAAA,GAAA;IACA,YAAA,CAAA,YAAA,CAAA,UAAA,GAAA,EAAA,GAAA;IACA,YAAA,CAAA,YAAA,CAAA,UAAA,GAAA,EAAA,GAAA;AACF,CAAA,EALY,6CAAA,CAAA,4CAKX,CAAA,CAAA;AAED;;;;;;;;;;;;;;;;;;CAkBG,GACU,MAAA;IAmEX;;;;;;;;KAQG,GACH,YAAY,UACV,OAAM,sBACN,mBAAkB,WAClB,QAAO,UACP,OAAM,MACN,KAAK,sDACL,SAAQ,aACR,YAAY,EAAE,WACd,OAAM,SACN,MAAK,UACL,OAAM,WACN,UAAU,SACV,MAAM,qDACN,QAAO,EACO,CAAA;QA9BR,IAAQ,CAAA,QAAA,GAAG;QACX,IAAS,CAAA,SAAA,GAAgC,EAAE;QAC3C,IAAI,CAAA,IAAA,GAAG,KAAK;QACZ,IAAO,CAAA,OAAA,GAAG,KAAK;QAEf,IAAM,CAAA,MAAA,GAAiB,EAAE;QA0B/B,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,kBAAkB,GAAG;QAC1B,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,EAAE,GAAG,MAAM,2CAAhB,4BAAA;QACA,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,SAAS,GAAG;QACjB,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,GAAG,GAAG;QACX,IAAI,CAAC,OAAO,GAAG;QAEf,IAAI,0CAAO,QAAQ,EAAE;YACnB,IAAI,CAACA,oCAAQ,IAAI,CAAC,OAAO,EAAE,0CAAO,QAAQ,CAAC,OAAO,GAChD,MAAM,IAAI,MACR,CAA2D,wDAAA,EAAA,KAAK,SAAS,CACvE,IAAI,CAAC,OAAO,EACb,KAAA,EAAQ,KAAK,SAAS,CAAC,0CAAO,QAAQ,CAAC,OAAO,EAAG,CAAA,EAClD;YAGJ,OAAO,0CAAO,QAAQ;QACvB,CAAA;QAED,0CAAO,QAAQ,GAAG,IAAI;IACvB;IAED,IAAW,UAAO;QAChB,OAAO;YACL,SAAS,IAAI,CAAC,OAAO;YACrB,QAAQ,IAAI,CAAC,MAAM;YACnB,SAAS,IAAI,CAAC,OAAO;YACrB,QAAQ,IAAI,CAAC,MAAM;YACnB,IAAI,IAAI,CAAC,EAAE;YACX,WAAW,IAAI,CAAC,SAAS;YACzB,UAAU,IAAI,CAAC,QAAQ;YACvB,QAAQ,IAAI,CAAC,MAAM;YACnB,QAAQ,IAAI,CAAC,MAAM;YACnB,OAAO,IAAI,CAAC,KAAK;YACjB,KAAK,IAAI,CAAC,GAAG;YACb,oBAAoB,IAAI,CAAC,kBAAkB;QAC5C;IACF;IAED,IAAW,SAAM;QACf,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EACpB,OAAO,0CAAa,OAAO;QAE7B,IAAI,IAAI,CAAC,IAAI,EACX,OAAO,0CAAa,OAAO;QAE7B,IAAI,IAAI,CAAC,OAAO,EACd,OAAO,0CAAa,OAAO;QAE7B,OAAO,0CAAa,WAAW;IAChC;IAED,IAAY,SAAM;QAChB,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,GAAG;IAC3E;IAED;;;;KAIG,GACI,YAAS;QACd,IAAI,MAAM,IAAI,CAAC,GAAG;QAElB,OAAO,CAAa,UAAA,EAAA,IAAI,CAAC,QAAQ,CAAA,CAAE;QAEnC,IAAI,IAAI,CAAC,MAAM,EACb,OAAO,CAAQ,KAAA,EAAA,IAAI,CAAC,MAAM,CAAA,CAAE;QAG9B,IAAI,IAAI,CAAC,OAAO,EACd,OAAO,CAAY,SAAA,EAAA,IAAI,CAAC,OAAO,CAAA,CAAE;QAGnC,IAAI,IAAI,CAAC,MAAM,EACb,OAAO,CAAW,QAAA,EAAA,IAAI,CAAC,MAAM,CAAA,CAAE;QAGjC,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,GAC1B,OAAO,CAAc,WAAA,EAAA,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAI,CAAE;QAGjD,IAAI,IAAI,CAAC,QAAQ,EACf,OAAO,CAAa,UAAA,EAAA,IAAI,CAAC,QAAQ,CAAA,CAAE;QAGrC,IAAI,IAAI,CAAC,MAAM,EACb,OAAO,CAAW,QAAA,EAAA,IAAI,CAAC,MAAM,CAAA,CAAE;QAGjC,IAAI,IAAI,CAAC,OAAO,EACd,OAAO,CAAM,GAAA,EAAA,IAAI,CAAC,OAAO,CAAA,CAAE;QAG7B,IAAI,IAAI,CAAC,MAAM,EACb,OAAO,CAAY,SAAA,EAAA,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAI,CAAE;QAG5C,IAAI,IAAI,CAAC,kBAAkB,EACzB,OAAO,CAAyB,sBAAA,EAAA,IAAI,CAAC,kBAAkB,CAAA,CAAE;QAG3D,OAAO;IACR;IAEM,eAAY;QACjB,MAAM,SAAS,SAAS,cAAc,CAAC,IAAI,CAAC,EAAE;QAC9C,IAAI,QACF,OAAO,MAAM;IAEhB;IAED;;KAEG,GACI,OAAI;QACT,OAAO,IAAI,CAAC,WAAW;IACxB;IAED;;;;KAIG,GACI,cAAW;QAChB,OAAO,IAAI,QAAQ,CAAC,SAAS,SAAU;YACrC,IAAI,CAAC,YAAY,CAAC,CAAC,MAAmB;gBACpC,IAAI,CAAC,KACH,QAAQ,OAAO,MAAM;qBAErB,OAAO,IAAI,KAAK;YAEpB;QACF;IACD;IAED;;KAEG,GACI,aAAa,EAA2B,EAAA;QAC7C,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;QACpB,IAAI,CAAC,OAAO;IACb;IAED;;KAEG,GACK,YAAS;QACf,IAAI,SAAS,cAAc,CAAC,IAAI,CAAC,EAAE,GAAG;Y,6E;YAEpC,IAAI,CAAC,QAAQ;YACb;QACD,CAAA;QAED,MAAM,MAAM,IAAI,CAAC,SAAS;QAC1B,MAAM,SAAS,SAAS,aAAa,CAAC;QACtC,OAAO,EAAE,GAAG,IAAI,CAAC,EAAE;QACnB,OAAO,IAAI,GAAG;QACd,OAAO,GAAG,GAAG;QACb,OAAO,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI;QACjD,OAAO,KAAK,GAAG,IAAI;QACnB,OAAO,KAAK,GAAG,IAAI;QAEnB,IAAI,IAAI,CAAC,KAAK,EACZ,OAAO,KAAK,GAAG,IAAI,CAAC,KAAK;QAG3B,SAAS,IAAI,CAAC,WAAW,CAAC;IAC3B;IAED;;KAEG,GACK,QAAK;QACX,IAAI,CAAC,YAAY;QACjB,IAAI,CAAC,IAAI,GAAG,KAAK;QACjB,IAAI,CAAC,OAAO,GAAG,KAAK;QACpB,IAAI,CAAC,MAAM,GAAG,EAAE;QAChB,IAAI,CAAC,YAAY,GAAG,IAAI;IACzB;IAEO,wBAAqB;QAC3B,IAAI,IAAI,CAAC,MAAM,EACb,IAAI,CAAC,KAAK;IAEb;IAEO,kBAAkB,CAAa,EAAA;QACrC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;QAEjB,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,EAAE;YACtC,MAAM,QAAQ,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,KAAA,GAAA,CAAA,GAAK,IAAI,CAAC,MAAM,CAAC,MAAM;YAE1D,QAAQ,GAAG,CACT,CAAA,+CAAA,EAAkD,MAAK,IAAA,CAAM;YAG/D,WAAW,IAAK;gBACd,IAAI,CAAC,YAAY;gBACjB,IAAI,CAAC,SAAS;YACf,GAAE;QACJ,OAAM;YACL,IAAI,CAAC,YAAY,GAAG;YACpB,IAAI,CAAC,QAAQ;QACd,CAAA;IACF;IAEO,cAAW;QACjB,OAAO,oBAAoB,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI;IACtD;IAEO,WAAQ;QACd,IAAI,CAAC,IAAI,GAAG,IAAI;QAChB,IAAI,CAAC,OAAO,GAAG,KAAK;QAEpB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,KAAM;YAC5B,GAAG,IAAI,CAAC,YAAY;QACtB;QAEA,IAAI,CAAC,SAAS,GAAG,EAAE;IACpB;IAEO,UAAO;QACb,IAAI,CAAC,qBAAqB;QAE1B,IAAI,IAAI,CAAC,IAAI,EACX,IAAI,CAAC,QAAQ;aACR;Y,0D;YAEL,IAAI,OAAO,MAAM,IAAI,OAAO,MAAM,CAAC,IAAI,IAAI,OAAO,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE;gBACrE,QAAQ,IAAI,CACV;gBAGF,IAAI,CAAC,QAAQ;gBACb;YACD,CAAA;YAED,IAAI,IAAI,CAAC,OAAO;iBAET;gBACL,IAAI,CAAC,OAAO,GAAG,IAAI;gBACnB,IAAI,CAAC,WAAW;gBAChB,IAAI,CAAC,SAAS;YACf,CAAA;QACF,CAAA;IACF;AACF;;;AP5hBM,MAAM,kDAAyB,CAAA,GAAA,wCAAgB,AAAD;IAMjD,YAAY,MAAc,EAAE,GAAQ,EAAE,MAAc,EAAE,gBAAwB,EAAE,QAAkC,CAAE;QAEhH,MAAM,SAAS,IAAI,CAAA,GAAA,yCAAK,EAAE;YACtB,QAAQ;YACR,SAAS;YACT,WAAW;gBAAC;gBAAU;aAAU;QACpC;QAEA,OAAO,IAAI,GAAG,IAAI,CAAC,CAAC,SAAW;YAC3B,IAAI,CAAC,MAAM,GAAG;QAClB,GACK,KAAK,CAAC,CAAA,IAAK;QACR,eAAe;QACnB;QAEJ,KAAK,CAAC,KAAK,QAAQ,kBAAkB;QAErC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO;IAEnC;IAGA,aAAa;QACT,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,UAAY;YAC/B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;QACzB;IACJ;IAEA,QAAQ,OAAiB,EAAE;QAEvB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CACpB;IAGR;IAEA,sBAAsB;QAElB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,UAAY;YAEhC,IAAI,QAAQ,WAAW,CAAC,kBAAkB,QAAO;gBAE7C,MAAM,eAAe,IAAI,CAAC,gBAAgB,CAAC,QAAQ,WAAW,CAAC;gBAE/D,MAAM,YAAY,IAAI,CAAC,gBAAgB,CAAC,aAAa;gBACrD,MAAM,cAAc,IAAI,CAAC,gBAAgB,CAAC,aAAa;gBACvD,MAAM,eAAe;gBAErB,MAAM,QAAQ;oBACV,aAAa;oBACb,oBAAoB;oBACpB,gBAAgB;oBAChB,eAAe;gBAEnB;gBAEA,OAAO;YACX,CAAC;QAEL;QAEA,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,QAAe;YAC/C,MAAM,UAAU,MAAM,OAAO;YAE7B,IAAI,QAAQ,WAAW,IAAI,UAAU,QAAQ,WAAW,IAAI,UAAS;gBAEjE,IAAI,OAAO,IAAI,CAAC,OAAO;gBAEvB,IAAI,QAAQ,MAAM,QAAQ,KAAK,IAAI,GAC/B,IAAI,CAAC,kBAAkB,CAAC;qBAIxB,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,EAAE,QAAQ,CAAC;YAErD,CAAC;QACL;IACJ;IAEA,kBAAkB,CAClB;IAEA,cAAc,OAAgB,EAAE;QAC5B,uBAAuB;QACvB,MAAM,aAAa,IAAI,CAAC,aAAa,CAAC;QAEtC,MAAM,WAAW,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,EAAE,EAAE,WAAW,IAAI,CAAC,EAAE;QACjF,MAAM,SAAS,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,MAAM,CAAC,EAAE,EAAE,WAAW,MAAM,CAAC,EAAE;QAEpF,MAAM,aAAa;YACf,OAAO,WAAW,GAAG;YACrB,QAAQ;YACR,UAAU;QACd;QAEA,OAAO;IACX;IAEA,WAAW,OAAgB,EAAE;QAEzB,MAAM,aAAa,IAAI,CAAC,aAAa,CAAC;QAEtC,MAAM,gBAAgB;YAClB,OAAO,IAAI,CAAC,GAAG;YACf,YAAY;gBACR,OAAO,QAAQ,MAAM,CAAC,CAAC;gBACvB,OAAO,QAAQ,MAAM,CAAC,CAAC;YAC3B;YACA,QAAQ;QACZ;QAEA,IAAI,SAAS,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QAEzC,SAAS,IAAI,CAAC,cAAc,CAAC,QAAQ;QAErC,IAAI,CAAC,sBAAsB,CAAC;QAE5B,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;IACzB;IAEA,SAAS,OAAgB,EAAE;QACvB,MAAM,QAAQ,QAAQ,KAAK;QAE3B,IAAI,SAAS,GACT,IAAI,CAAC,UAAU,CAAC;aAGf;YAED,MAAM,UAAU;gBACZ,QAAQ;gBACR,YAAY,QAAQ,OAAO;gBAC3B,cAAc;oBACV,eAAgB;oBAChB,KAAK,QAAQ,MAAM,CAAC,CAAC;oBACrB,KAAK,QAAQ,MAAM,CAAC,CAAC;oBACrB,SAAS;oBACT,WAAW,QAAQ,OAAO;gBAC9B;YACJ;YAEA,MAAM,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE;YAEjD,KAAK,CAAC,GAAG,QAAQ,MAAM,CAAC,CAAC;YACzB,KAAK,CAAC,GAAG,QAAQ,MAAM,CAAC,CAAC;YACzB,KAAK,KAAK,GAAG;YACb,KAAK,OAAO,GAAG;YACf,KAAK,WAAW,GAAG;QAEvB,CAAC;IACL;IAEA,mBAAmB;QAEf,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,IACxC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI;QAGlC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,UAAY;YAC/B,IAAI,QAAQ,WAAW,IAAI,QACvB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;QAE7B;QAEA,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG;IAC7B;IAEA,uBAAuB;QACnB,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW,IAAM,IAAI,CAAC,WAAW;QACtD,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,gBAAgB,IAAM;YACvC,IAAI,CAAC,gBAAgB;YACrB,IAAI,CAAC,WAAW;QACpB;IACJ;IAGA,cAAwB;QAEpB,MAAM,eAAe,IAAI,CAAC,GAAG,CAAC,SAAS;QACvC,MAAM,YAAY,aAAa,YAAY;QAC3C,MAAM,YAAY,aAAa,YAAY;QAE3C,MAAM,WAAW;YACb,QAAQ,UAAU,GAAG;YACrB,SAAS,UAAU,GAAG;YACtB,OAAO,UAAU,GAAG;YACpB,UAAU,UAAU,GAAG;QAC3B;QAEA,OAAO;IACX;IAEA,UAAkB;QACd,OAAO,IAAI,CAAC,GAAG,CAAC,OAAO;IAC3B;IAEA,QAAQ,IAAY,EAAQ;QACxB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC;IACrB;IAGA,OAAO,CAAS,EAAE,CAAS,EAAE,IAAY,EAAQ;QAE7C,MAAM,aAAa;YACf,UAAU;gBACN,KAAK;gBACL,KAAK;YACT;YACA,QAAQ;QACZ;QAEA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;IACxB;IAEA,uBAAuB,MAAM,EAAE;QAE3B,MAAM,OAAO,IAAI,CAAC,OAAO;QAEzB,IAAI,QAAQ,MAAM,OAAO,KAAK,IAAI,GAC9B,OAAO,WAAW,CAAC,SAAS,CAAC,QAAU;YACnC,IAAI,CAAC,kBAAkB,CAAC;QAC5B;aAIA,OAAO,WAAW,CAAC,SAAS,CAAC,QAAU;YACnC,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAE,OAAO,CAAC;QAC/C;IAER;AAEJ;;AD5PA","sources":["src/index.ts","src/anycluster-google.ts","../src/index.ts","../src/consts.ts","../src/anycluster.ts","../src/anycluster-client.ts","node_modules/@googlemaps/js-api-loader/dist/index.esm.js","node_modules/@googlemaps/js-api-loader/node_modules/fast-deep-equal/index.js","node_modules/@googlemaps/js-api-loader/src/index.ts"],"sourcesContent":["export {\n    ClusterMethod,\n    AnyclusterGoogle,\n} from \"./anycluster-google\";","import {\n    AnyclusterClient,\n    AnyclusterClientSettings,\n    Viewport,\n    Cluster,\n    ClusterMethod,\n    GeoJSON as IGeoJSON,\n} from 'anycluster-client';\n\nimport { Loader } from '@googlemaps/js-api-loader';\n\nexport {\n    ClusterMethod\n};\n\nexport class AnyclusterGoogle extends AnyclusterClient {\n\n    currentZoom: number\n\n    google: any\n\n    constructor(apiKey: string, map: any, apiUrl: string, markerFolderPath: string, settings: AnyclusterClientSettings) {\n\n        const loader = new Loader({\n            apiKey: apiKey,\n            version: \"monthly\",\n            libraries: [\"marker\", \"drawing\"]\n        });\n\n        loader.load().then((google) => {\n            this.google = google;\n        })\n            .catch(e => {\n                // do something\n            });\n\n        super(map, apiUrl, markerFolderPath, settings);\n\n        this.currentZoom = this.getZoom();\n\n    }\n\n\n    removeArea() {\n        this.map.data.forEach((feature) => {\n            this.map.data.remove(feature);\n        });\n    }\n\n    addArea(geojson: IGeoJSON) {\n\n        this.map.data.addGeoJson(\n            geojson\n        );\n\n    }\n\n    createClusterLayers() {\n\n        this.map.data.setStyle((feature) => {\n\n            if (feature.getProperty(\"clustertype\") == \"cell\"){\n\n                const roundedCount = this.roundMarkerCount(feature.getProperty(\"count\"));\n\n                const fillColor = this.gridStrokeColors[roundedCount];\n                const strokeColor = this.gridStrokeColors[roundedCount];\n                const strokeWeight = 1;\n\n                const style = {\n                    \"fillColor\": fillColor,\n                    //\"fillOpacity\": .5,\n                    \"strokeWeight\": strokeWeight,\n                    \"strokeColor\": strokeColor,\n                    //\"strokeOpacity\": .8\n                };\n\n                return style;\n            }\n\n        });\n\n        this.map.data.addListener(\"click\", (event: any) => {\n            const feature = event.feature;\n\n            if (feature.clustertype == \"cell\" || feature.clustertype == \"marker\"){\n\n                let zoom = this.getZoom();\n\n                if (zoom >= 13 || feature.count == 1) {\n                    this.onMarkerFinalClick(feature);\n                }\n\n                else {\n                    this.markerClickFunction(feature.x, feature.y);\n                }\n            }\n        });\n    }\n\n    createAreaLayer() {\n    }\n\n    getMarkerIcon(cluster: Cluster) {\n        // get the correct icon\n        const piniconObj = this.selectPinIcon(cluster);\n\n        const iconSize = new this.google.maps.Size(piniconObj.size[0], piniconObj.size[1]);\n        const anchor = new this.google.maps.Point(piniconObj.anchor[0], piniconObj.anchor[1]);\n\n        const markerIcon = {\n            \"url\": piniconObj.url,\n            \"size\": iconSize,\n            \"anchor\": anchor,\n        };\n\n        return markerIcon;\n    }\n\n    drawMarker(cluster: Cluster) {\n\n        const markerIcon = this.getMarkerIcon(cluster);\n\n        const markerOptions = {\n            \"map\": this.map,\n            \"position\": {\n                \"lat\": cluster.center.y,\n                \"lng\": cluster.center.x\n            },\n            \"icon\": markerIcon,\n        };\n\n        let marker = new this.google.maps.Marker(markerOptions);\n\n        marker = this.setMarkerProps(marker, cluster);\n\n        this.addMarkerClickListener(marker);\n\n        this.markerList.push(marker);\n    }\n\n    drawCell(cluster: Cluster) {\n        const count = cluster.count;\n\n        if (count == 1) {\n            this.drawMarker(cluster);\n        }\n\n        else {\n\n            const geojson = {\n                \"type\": \"Feature\",\n                \"geometry\": cluster.geojson,\n                \"properties\": {\n                    \"clustertype\" : \"cell\",\n                    \"x\": cluster.center.x,\n                    \"y\": cluster.center.y,\n                    \"count\": count,\n                    \"geojson\": cluster.geojson,\n                }\n            };\n\n            const cell = this.map.data.addGeoJson(geojson)[0];\n\n            cell.x = cluster.center.x;\n            cell.y = cluster.center.y;\n            cell.count = count;\n            cell.geojson = geojson;\n            cell.clustertype = \"cell\";\n\n        }\n    }\n\n    removeAllMarkers() {\n\n        for (let i = 0; i < this.markerList.length; i++) {\n            this.markerList[i].setMap(null);\n        }\n\n        this.map.data.forEach((feature) => {\n            if (feature.clustertype == \"cell\"){\n                this.map.data.remove(feature);\n            }\n        });\n\n        this.markerList.length = 0;\n    }\n\n    addMapEventListeners() {\n        this.map.addListener(\"dragend\", () => this.getClusters());\n        this.map.addListener(\"zoom_changed\", () => {\n            this.removeAllMarkers();\n            this.getClusters();\n        });\n    }\n\n\n    getViewport(): Viewport {\n\n        const latLngBounds = this.map.getBounds();\n        const northEast = latLngBounds.getNorthEast();\n        const southWest = latLngBounds.getSouthWest();\n\n        const viewport = {\n            \"left\": southWest.lng(),\n            \"right\": northEast.lng(),\n            \"top\": northEast.lat(),\n            \"bottom\": southWest.lat(),\n        };\n\n        return viewport;\n    }\n\n    getZoom(): number {\n        return this.map.getZoom();\n    }\n\n    setZoom(zoom: number): void {\n        this.map.setZoom(zoom);\n    }\n\n\n    setMap(x: number, y: number, zoom: number): void {\n\n        const mapOptions = {\n            \"center\": {\n                lat: y,\n                lng: x\n            },\n            \"zoom\": zoom,\n        };\n\n        this.map.setOptions(mapOptions);\n    }\n\n    addMarkerClickListener(marker) {\n\n        const zoom = this.getZoom();\n\n        if (zoom >= 13 || marker.count == 1) {\n            marker.addListener(\"click\", (event) => {\n                this.onMarkerFinalClick(marker);\n            });\n        }\n\n        else {\n            marker.addListener(\"click\", (event) => {\n                this.markerClickFunction(marker.x, marker.y);\n            });\n        }\n    }\n\n}","export {\n    ClusterMethod,\n    GeometryType,\n    IconType,\n    SRIDS,\n    Operators\n} from \"./consts\";\n\nexport { \n    Anycluster\n} from \"./anycluster\";\n\nexport {\n    AnyclusterClient\n} from \"./anycluster-client\";","\nexport interface MaxBounds {\n    minX: number,\n    maxX: number,\n    minY: number,\n    maxY: number\n}\n\nexport enum SRIDS {\n    EPSG4326 = 'EPSG:4326',\n    EPSG3857 = 'EPSG:3857'\n}\n\nexport enum ClusterMethod {\n    kmeans = 'kmeans',\n    grid = 'grid'\n}\n\n\nexport enum GeometryType {\n    viewport = 'viewport',\n    area = 'area'\n}\n\nexport enum IconType {\n    exact = 'exact',\n    rounded = 'rounded'\n}\n\nexport enum DefaultGridSizes {\n    grid = 64,\n    kmeans = 150\n}\n\nexport const DefaultMarkerImageSizes = {\n    1: [24, 39],\n    5: [30, 30],\n    10: [30, 30],\n    50: [40, 40],\n    100: [40, 40],\n    1000: [50, 50],\n    10000: [60, 60]\n}\n\nexport enum Operators {\n    in = 'in',\n    notIn = 'not in',\n    equals = '=',\n    unEquals = '!=',\n    largerThan = '>=',\n    smallerThan = '<=',\n    startswith = 'startswith',\n    contains = 'contains',\n}","import { SRIDS, MaxBounds, ClusterMethod, GeometryType, Operators } from \"./consts\";\nimport { Point, GeoJSON, Coordinates, Viewport } from \"./geometry\";\n\nexport const Bounds4326: MaxBounds = Object.freeze({\n    minX: -179,\n    maxX: 179,\n    minY: -89,\n    maxY: 89\n})\n\n\nexport const Bounds3857: MaxBounds = Object.freeze({\n    minX: -20037500, //-20037508.34\n    maxX: 20037500, // 20037508.34\n    minY: -20048960, // -20048966.1\n    maxY: 20048960 //  20048966.1\n})\n\nexport interface Filter {\n    column: string\n    value: string | number | boolean\n    operator: Operators\n}\n\nexport interface ClusterRequestData {\n    output_srid: SRIDS\n    geometry_type: GeometryType\n    geojson: GeoJSON\n    clear_cache: boolean\n    filters: Filter[]\n}\n\nexport type FilterList = Filter[]\n\nexport interface GetKmeansClusterContentRequestData {\n    geometry_type: GeometryType\n    input_srid: SRIDS\n    x: number\n    y: number\n    ids: number[]\n}\n\n\nexport class Anycluster {\n\n    maxBounds: MaxBounds\n\n    constructor(private apiUrl: string, public gridSize: number, public srid: SRIDS) {\n\n        if (this.srid == SRIDS.EPSG4326) {\n            this.maxBounds = Bounds4326;\n        }\n        else if (this.srid == SRIDS.EPSG3857) {\n            this.maxBounds = Bounds3857;\n        }\n        else {\n            throw new Error(`invalid srid given: ${this.srid} `);\n        }\n\n    }\n\n    async getGridCluster(zoom: number, data: ClusterRequestData) {\n        const url = `${this.apiUrl}grid/${zoom}/${this.gridSize}/`;\n        const clusters = await this.post(url, data);\n        return clusters;\n    }\n\n    async getKmeansCluster(zoom: number, data: ClusterRequestData) {\n\n        const url = `${this.apiUrl}kmeans/${zoom}/${this.gridSize}/`;\n        const clusters = await this.post(url, data);\n        return clusters\n    }\n\n    async getKmeansClusterContent(zoom: number, data: GetKmeansClusterContentRequestData) {\n\n        const url = `${this.apiUrl}get-kmeans-cluster-content/${zoom}/${this.gridSize}/`;\n\n        const clusterContent = await this.post(url, data);\n\n        return clusterContent;\n    }\n\n    async getDatasetContent(zoom: number, datasetId: number) {\n        const url = `${this.apiUrl}get-dataset-content/${zoom}/${this.gridSize}/${datasetId}/`;\n\n        const clusterContent = await this.get(url);\n\n        return clusterContent;\n    }\n\n    getAreaContent() {\n\n    }\n\n    viewportToGeoJSON(viewport: Viewport) {\n\n        const left = Math.max(viewport.left, this.maxBounds.minX);\n        const right = Math.min(viewport.right, this.maxBounds.maxX);\n        const top = Math.min(viewport.top, this.maxBounds.maxY);\n        const bottom = Math.max(viewport.bottom, this.maxBounds.minY);\n\n        const geometryType = \"Polygon\";\n\n        const coordinates = [[\n            [left, top],\n            [right, top],\n            [right, bottom],\n            [left, bottom],\n            [left, top]\n        ]];\n\n        const geoJSON = {\n            \"type\": \"Feature\",\n            \"geometry\": {\n                \"type\": geometryType,\n                \"coordinates\": coordinates,\n                \"crs\": {\n                    \"type\": \"name\",\n                    \"properties\": {\n                        \"name\": this.srid\n                    }\n                }\n            }\n        };\n\n        return geoJSON;\n    }\n\n    async post(url: string, postData: object) {\n\n        const encodedUrl = encodeURI(url);\n\n        const options = {\n            method: 'POST',\n            body: JSON.stringify(postData),\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors' as 'cors',\n            credentials: 'include' as 'include'\n        }\n\n        const response = await fetch(encodedUrl, options);\n        const responseData = await response.json();\n\n        if (response.ok) {\n            return responseData\n        }\n        else {\n            throw new Error(JSON.stringify(responseData));\n        }\n\n    }\n\n    async get(url: string) {\n        const encodedUrl = encodeURI(url);\n\n        const options = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            mode: 'cors' as 'cors',\n            credentials: 'include' as 'include'\n        }\n\n        const response = await fetch(encodedUrl, options);\n        const responseData = await response.json();\n\n        if (response.ok) {\n            return responseData\n        }\n        else {\n            throw new Error(JSON.stringify(responseData));\n        }\n    }\n}","\nimport { ClusterMethod, GeometryType, IconType, SRIDS, DefaultGridSizes, DefaultMarkerImageSizes } from \"./consts\";\nimport { GeoJSON, Marker, Cluster, Viewport } from \"./geometry\";\nimport { Anycluster, GetKmeansClusterContentRequestData, ClusterRequestData, Filter, FilterList } from \"./anycluster\";\n\n\nconst defaultGridFillColors = {\n    5: \"rgba(255, 192, 203, .5)\",\n    10: \"rgba(240, 128, 128, .5)\",\n    50: \"rgba(255, 127, 80, .5)\",\n    100: \"rgba(255, 165, 0, .5)\",\n    1000: \"rgba(255, 69, 0, .5)\",\n    10000: \"rgba(255, 0 , 0, .5)\"\n};\n\nconst defaultGridStrokeColors = {\n    5: \"pink\",\n    10: \"lightcoral\",\n    50: \"coral\",\n    100: \"orange\",\n    1000: \"orangered\",\n    10000: \"red\"\n};\n\nexport interface AnyclusterClientSettings {\n    srid?: SRIDS // srid of the map\n    kmeansGridSize?: number\n    gridGridSize?: number\n    clusterMethod?: ClusterMethod\n    geometryType?: GeometryType\n    area?: any\n    iconType?: IconType\n    onFinalClick?: Function\n    singlePinImages?: Record<string, string>\n    markerImageSizes?: Record<string, number[]>\n    gridFillColors?: Record<number, string>\n    gridStrokeColors?: Record<number, string>\n}\n\nexport class AnyclusterClient {\n\n    srid: SRIDS\n    kmeansGridSize: number\n    gridGridSize: number\n    clusterMethod: ClusterMethod\n    geometryType: GeometryType\n\n    area: GeoJSON | null\n    iconType: IconType\n\n    anycluster: Anycluster\n    markerList: any[]\n    onFinalClick: Function\n    singlePinImages?: Record<string, string>\n\n    markerImageSizes: Record<string, number[]>\n\n    gridFillColors: Record<number, string>\n    gridStrokeColors: Record<number, string>\n\n    filters: FilterList = []\n\n\n    constructor(public map: any, public apiUrl: string, public markerFolderPath: string, settings: AnyclusterClientSettings) {\n\n        this.map = map;\n        this.apiUrl = apiUrl;\n        this.markerFolderPath = markerFolderPath;\n\n        settings = settings || {};\n\n\n        // settings\n        this.srid = settings.srid ? settings.srid : SRIDS.EPSG4326;\n        this.kmeansGridSize = settings.gridGridSize ? settings.gridGridSize : DefaultGridSizes.kmeans;\n        this.gridGridSize = settings.gridGridSize ? settings.gridGridSize : DefaultGridSizes.grid;\n\n        this.clusterMethod = settings.clusterMethod ? settings.clusterMethod : ClusterMethod.kmeans;\n        this.geometryType = settings.geometryType ? settings.geometryType : GeometryType.viewport;\n\n        this.area = settings.area ? settings.area : null;\n        this.iconType = settings.iconType ? settings.iconType : IconType.rounded;\n\n        this.onFinalClick = settings.onFinalClick ? settings.onFinalClick : this._onFinalClick;\n\n        this.singlePinImages = settings.singlePinImages ? settings.singlePinImages : {};\n\n        this.markerImageSizes = settings.markerImageSizes ? settings.markerImageSizes : DefaultMarkerImageSizes;\n\n        this.gridFillColors = settings.gridFillColors ? settings.gridFillColors : defaultGridFillColors;\n        this.gridStrokeColors = settings.gridStrokeColors ? settings.gridStrokeColors : defaultGridStrokeColors;\n\n\n        if (this.area) {\n            this.setArea(this.area);\n        }\n\n        const gridSize = this.getGridSize();\n        this.anycluster = new Anycluster(this.apiUrl, gridSize, this.srid);\n\n        this.createClusterLayers();\n        this.markerList = [];\n\n        this.startClustering();\n    }\n\n    createClusterLayers(): void {\n        throw new Error(\"NotImplementedError: createClusterLayers\");\n    }\n\n    addArea(geojson: object): void {\n        throw new Error(\"NotImplementedError: addArea\");\n    }\n\n    removeArea(): void {\n        throw new Error(\"NotImplementedError: removeArea\");\n    }\n\n    removeAllMarkers(): void {\n        throw new Error(\"NotImplementedError: removeAllMarkers\");\n    }\n\n    getZoom(): number {\n        throw new Error(\"NotImplementedError: getZoom\");\n    }\n\n    setMap(x: number, y: number, zoom: number): void {\n        throw new Error(\"NotImplementedError: setMap\");\n    }\n\n    getViewport(): Viewport {\n        throw new Error(\"NotImplementedError: setMap\");\n    }\n\n    addMapEventListeners(): void {\n        throw new Error(\"NotImplementedError: addMapEventListeners\");\n    }\n\n    drawMarker(cluster: Cluster): void {\n        throw new Error(\"NotImplementedError: drawMarker\");\n    }\n\n    drawCell(cluster: Cluster): void {\n        throw new Error(\"NotImplementedError: drawCell\");\n    }\n\n    getAreaContent(geojson: GeoJSON): void {\n        throw new Error(\"NotImplementedError: getAreaContent\");\n    }\n\n\n    getGridSize(): number {\n        if (this.clusterMethod == ClusterMethod.grid) {\n            return this.gridGridSize;\n        }\n\n        return this.kmeansGridSize;\n    }\n\n    setClusterMethod(clusterMethod: ClusterMethod) {\n\n        if (clusterMethod == ClusterMethod.grid) {\n            this.area = null;\n            this.geometryType = GeometryType.viewport;\n            this.removeArea();\n        }\n\n        this.removeAllMarkers();\n        this.clusterMethod = clusterMethod;\n        const gridSize = this.getGridSize();\n        this.anycluster = new Anycluster(this.apiUrl, gridSize, this.srid);\n        this.markerList = [];\n        this.getClusters(true);\n    }\n\n    setArea(geojson: GeoJSON) {\n\n        this.area = geojson;\n\n        this.removeArea();\n\n        if (geojson == null) {\n            this.geometryType = GeometryType.viewport;\n            this.setClusterMethod(ClusterMethod.kmeans);\n        }\n        else {\n\n            this.addArea(geojson);\n\n            this.geometryType = GeometryType.area;\n\n            this.setClusterMethod(ClusterMethod.kmeans);\n        }\n    }\n\n    getSinglePinImageURL(cluster: Cluster) {\n\n        const pinimg = cluster.pinimg;\n\n        let url = `${this.markerFolderPath}pin_unknown.png`;\n\n        if (this.singlePinImages && pinimg && pinimg in this.singlePinImages) {\n            url = this.singlePinImages[pinimg];\n        }\n\n        return url\n\n    }\n\n    selectPinIcon(cluster: Cluster) {\n\n        const count = cluster.count;\n\n        let markerImageUrl = this.getSinglePinImageURL(cluster);\n        let pinicon = \"1\";\n\n        if (count > 10000) {\n            pinicon = \"10000\";\n        }\n\n        else if (count > 1000) {\n            pinicon = \"1000\";\n        }\n\n        else if (count > 100) {\n            pinicon = \"100\";\n        }\n\n        else if (count > 50) {\n            pinicon = \"50\";\n        }\n\n        else if (count > 10) {\n            pinicon = \"10\";\n        }\n\n        else if (count > 1) {\n            pinicon = \"5\";\n        }\n\n        if (count > 1) {\n            if (this.iconType == IconType.exact) {\n                markerImageUrl = `${this.markerFolderPath}${pinicon}_empty.png`;\n            }\n            else {\n                markerImageUrl = `${this.markerFolderPath}${pinicon}.png`;\n            }\n        }\n\n        const size = this.markerImageSizes[pinicon];\n        let anchor = [Math.round(size[0] / 2), size[1] - 1];\n        let relativeAnchor = [0.5, 1];\n\n        if (count > 1) {\n            anchor = [Math.round((size[0] / 2)), Math.round(size[1] / 2)];\n            relativeAnchor = [0.5, 0.5];\n        }\n\n        const imgObj = {\n            url: markerImageUrl,\n            size: size,\n            anchor: anchor,\n            relativeAnchor: relativeAnchor,\n            popupAnchor: [0, -Math.round(size[1]) + 8]\n        }\n\n        return imgObj;\n\n    }\n\n    // marker can be an openlayers Feature or a L.marker\n    setMarkerProps(marker: any, cluster: Cluster) {\n\n        // add properties required by anycluster\n        marker.x = cluster.center.x;\n        marker.y = cluster.center.y;\n        marker.count = cluster.count;\n\n        if (cluster.hasOwnProperty(\"ids\")) {\n            marker.ids = cluster.ids;\n        }\n\n        if (cluster.hasOwnProperty(\"id\")) {\n            marker.id = cluster.id;\n        }\n\n        if (cluster.hasOwnProperty(\"geojson\")) {\n\n            /*const geojson = {\n                \"type\": \"Feature\",\n                \"count\": cluster.count,\n                \"geometry\": cluster.geojson,\n                \"properties\": {\n                    \"count\": cluster.count\n                },\n                \"crs\" : {\n                    \"type\" : \"name\",\n                    \"properties\" : {\n                        \"name\" : this.srid\n                    }\n                }\n            };*/\n\n            marker.geojson = cluster.geojson;\n        }\n\n        return marker;\n\n    }\n\n    markerClickFunction(x: number, y: number) {\n        this.removeAllMarkers();\n        let zoom = this.getZoom();\n        zoom = zoom + 3;\n        this.setMap(x, y, zoom);\n    }\n\n    async onMarkerFinalClick(marker: any) {\n\n        const zoom = this.getZoom();\n        const x = marker.x;\n        const y = marker.y;\n        const ids = marker.ids;\n\n        if (this.clusterMethod == ClusterMethod.kmeans) {\n\n            const postData = {\n                \"geometry_type\": this.geometryType,\n                \"input_srid\": this.srid,\n                \"x\": x,\n                \"y\": y,\n                \"ids\": ids,\n                \"filters\": this.filters\n            } as GetKmeansClusterContentRequestData;\n\n            const data = await this.anycluster.getKmeansClusterContent(zoom, postData);\n\n            this.onFinalClick(marker, data);\n\n        }\n        else if (this.clusterMethod = ClusterMethod.grid) {\n\n            if (marker.count == 1) {\n                const data = await this.anycluster.getDatasetContent(zoom, marker.id);\n                this.onFinalClick(marker, data);\n            }\n            else {\n                const geojson = marker[\"geojson\"];\n                const data = await this.getAreaContent(geojson);\n\n                this.onFinalClick(marker, data);\n            }\n\n        }\n    }\n\n    roundMarkerCount(count: number): number {\n\n        if (count == 1) {\n            count = 1;\n        }\n        else if (count <= 5) {\n            count = 5;\n        }\n        else if (count <= 10) {\n            count = 10;\n        }\n        else if (count <= 50) {\n            count = 50;\n        }\n        else if (count <= 100) {\n            count = 100;\n        }\n        else if (count <= 1000) {\n            count = 1000;\n        }\n        else {\n            count = 10000;\n        }\n\n        return count;\n    }\n\n    getClusterGeometry() {\n        let geoJSON;\n\n        if (this.geometryType == GeometryType.viewport) {\n            const viewport = this.getViewport();\n            geoJSON = this.anycluster.viewportToGeoJSON(viewport);\n        }\n        else if (this.geometryType == GeometryType.area && this.area) {\n            geoJSON = this.area;\n        }\n        else {\n            throw new Error('No cluster geometry found');\n        }\n\n        return geoJSON;\n\n    }\n\n    async getClusters(clearCache = false) {\n\n        const geoJSON = this.getClusterGeometry()\n\n        const postData = {\n            \"output_srid\": this.srid,\n            \"geometry_type\": this.geometryType,\n            \"geojson\": geoJSON,\n            \"clear_cache\": clearCache,\n            \"filters\": this.filters\n        } as ClusterRequestData;\n\n        const zoom = this.getZoom();\n\n        if (this.clusterMethod == ClusterMethod.kmeans) {\n\n\n            const clusters: Cluster[] = await this.anycluster.getKmeansCluster(zoom, postData);\n\n            if (clusters.length > 0) {\n                clusters.forEach(cluster => {\n                    this.drawMarker(cluster);\n                });\n            }\n        }\n        else if (this.clusterMethod == ClusterMethod.grid) {\n            const clusters: Cluster[] = await this.anycluster.getGridCluster(zoom, postData);\n\n            if (clusters.length > 0) {\n                clusters.forEach(cluster => {\n                    this.drawCell(cluster);\n                });\n            }\n        }\n        else {\n            throw new Error(`Invalid clusterMethod: ${this.clusterMethod}`);\n        }\n    }\n\n    startClustering() {\n        this.getClusters(true);\n        this.addMapEventListeners();\n    }\n\n    _onFinalClick(marker: Marker, data: any) {\n        alert(JSON.stringify(data));\n    }\n\n    filtersAreEqual(filter1: Filter, filter2: Filter): boolean {\n        if (filter1.column == filter2.column && filter1.value == filter2.value && filter1.operator == filter2.operator) {\n            return true;\n        }\n\n        return false;\n    }\n\n    // filtering\n    filter(filter: Filter, reloadMarkers?: boolean) {\n        this.filters = [filter];\n        this.postFilterChange(reloadMarkers);\n    }\n\n    addFilter(filter: Filter, reloadMarkers?: boolean) {\n\n        let filterExists = false;\n\n        for (let f = 0; f < this.filters.length; f++) {\n            let existingFilter = this.filters[f];\n\n            if (this.filtersAreEqual(filter, existingFilter)) {\n                filterExists = true;\n                break;\n            }\n\n        }\n\n        if (!filterExists) {\n            this.filters.push(filter);\n        }\n\n        this.postFilterChange(reloadMarkers);\n    }\n\n    addFilters(filtersToAdd: FilterList, reloadMarkers?: boolean) {\n\n        for (let fa = 0; fa < filtersToAdd.length; fa++) {\n            let filter = filtersToAdd[fa];\n            this.addFilter(filter, false);\n        }\n        this.postFilterChange(reloadMarkers);\n    }\n\n    removeFilter(filter: Filter, reloadMarkers?: boolean) {\n\n        for (let f = 0; f < this.filters.length; f++) {\n            let existingFilter = this.filters[f];\n\n            if (this.filtersAreEqual(filter, existingFilter)) {\n                this.filters.splice(f, 1);\n                break;\n            }\n        }\n        this.postFilterChange(reloadMarkers);\n    }\n\n    removeFilters(filtersToRemove: FilterList, reloadMarkers?: boolean) {\n\n        for (let fr = 0; fr < filtersToRemove.length; fr++) {\n\n            let filter = filtersToRemove[fr];\n\n            this.removeFilter(filter, false);\n        }\n\n        this.postFilterChange(reloadMarkers);\n    }\n\n    resetFilters(reloadMarkers?: boolean) {\n        this.filters = [];\n        this.postFilterChange(reloadMarkers);\n    }\n\n    postFilterChange(reloadMarkers?: boolean) {\n        if (reloadMarkers != false){\n            reloadMarkers = true;\n        }\n        if (reloadMarkers == true) {\n            this.removeAllMarkers();\n            this.getClusters(true);\n        }\n    }\n\n}","// do not edit .js files directly - edit src/index.jst\n\n\n\nvar fastDeepEqual = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n\n/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at.\n *\n *      Http://www.apache.org/licenses/LICENSE-2.0.\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst DEFAULT_ID = \"__googleMapsScriptId\";\n/**\n * The status of the [[Loader]].\n */\nvar LoaderStatus;\n(function (LoaderStatus) {\n    LoaderStatus[LoaderStatus[\"INITIALIZED\"] = 0] = \"INITIALIZED\";\n    LoaderStatus[LoaderStatus[\"LOADING\"] = 1] = \"LOADING\";\n    LoaderStatus[LoaderStatus[\"SUCCESS\"] = 2] = \"SUCCESS\";\n    LoaderStatus[LoaderStatus[\"FAILURE\"] = 3] = \"FAILURE\";\n})(LoaderStatus || (LoaderStatus = {}));\n/**\n * [[Loader]] makes it easier to add Google Maps JavaScript API to your application\n * dynamically using\n * [Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise).\n * It works by dynamically creating and appending a script node to the the\n * document head and wrapping the callback function so as to return a promise.\n *\n * ```\n * const loader = new Loader({\n *   apiKey: \"\",\n *   version: \"weekly\",\n *   libraries: [\"places\"]\n * });\n *\n * loader.load().then((google) => {\n *   const map = new google.maps.Map(...)\n * })\n * ```\n */\nclass Loader {\n    /**\n     * Creates an instance of Loader using [[LoaderOptions]]. No defaults are set\n     * using this library, instead the defaults are set by the Google Maps\n     * JavaScript API server.\n     *\n     * ```\n     * const loader = Loader({apiKey, version: 'weekly', libraries: ['places']});\n     * ```\n     */\n    constructor({ apiKey, authReferrerPolicy, channel, client, id = DEFAULT_ID, language, libraries = [], mapIds, nonce, region, retries = 3, url = \"https://maps.googleapis.com/maps/api/js\", version, }) {\n        this.CALLBACK = \"__googleMapsCallback\";\n        this.callbacks = [];\n        this.done = false;\n        this.loading = false;\n        this.errors = [];\n        this.apiKey = apiKey;\n        this.authReferrerPolicy = authReferrerPolicy;\n        this.channel = channel;\n        this.client = client;\n        this.id = id || DEFAULT_ID; // Do not allow empty string\n        this.language = language;\n        this.libraries = libraries;\n        this.mapIds = mapIds;\n        this.nonce = nonce;\n        this.region = region;\n        this.retries = retries;\n        this.url = url;\n        this.version = version;\n        if (Loader.instance) {\n            if (!fastDeepEqual(this.options, Loader.instance.options)) {\n                throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(Loader.instance.options)}`);\n            }\n            return Loader.instance;\n        }\n        Loader.instance = this;\n    }\n    get options() {\n        return {\n            version: this.version,\n            apiKey: this.apiKey,\n            channel: this.channel,\n            client: this.client,\n            id: this.id,\n            libraries: this.libraries,\n            language: this.language,\n            region: this.region,\n            mapIds: this.mapIds,\n            nonce: this.nonce,\n            url: this.url,\n            authReferrerPolicy: this.authReferrerPolicy,\n        };\n    }\n    get status() {\n        if (this.errors.length) {\n            return LoaderStatus.FAILURE;\n        }\n        if (this.done) {\n            return LoaderStatus.SUCCESS;\n        }\n        if (this.loading) {\n            return LoaderStatus.LOADING;\n        }\n        return LoaderStatus.INITIALIZED;\n    }\n    get failed() {\n        return this.done && !this.loading && this.errors.length >= this.retries + 1;\n    }\n    /**\n     * CreateUrl returns the Google Maps JavaScript API script url given the [[LoaderOptions]].\n     *\n     * @ignore\n     */\n    createUrl() {\n        let url = this.url;\n        url += `?callback=${this.CALLBACK}`;\n        if (this.apiKey) {\n            url += `&key=${this.apiKey}`;\n        }\n        if (this.channel) {\n            url += `&channel=${this.channel}`;\n        }\n        if (this.client) {\n            url += `&client=${this.client}`;\n        }\n        if (this.libraries.length > 0) {\n            url += `&libraries=${this.libraries.join(\",\")}`;\n        }\n        if (this.language) {\n            url += `&language=${this.language}`;\n        }\n        if (this.region) {\n            url += `&region=${this.region}`;\n        }\n        if (this.version) {\n            url += `&v=${this.version}`;\n        }\n        if (this.mapIds) {\n            url += `&map_ids=${this.mapIds.join(\",\")}`;\n        }\n        if (this.authReferrerPolicy) {\n            url += `&auth_referrer_policy=${this.authReferrerPolicy}`;\n        }\n        return url;\n    }\n    deleteScript() {\n        const script = document.getElementById(this.id);\n        if (script) {\n            script.remove();\n        }\n    }\n    /**\n     * Load the Google Maps JavaScript API script and return a Promise.\n     */\n    load() {\n        return this.loadPromise();\n    }\n    /**\n     * Load the Google Maps JavaScript API script and return a Promise.\n     *\n     * @ignore\n     */\n    loadPromise() {\n        return new Promise((resolve, reject) => {\n            this.loadCallback((err) => {\n                if (!err) {\n                    resolve(window.google);\n                }\n                else {\n                    reject(err.error);\n                }\n            });\n        });\n    }\n    /**\n     * Load the Google Maps JavaScript API script with a callback.\n     */\n    loadCallback(fn) {\n        this.callbacks.push(fn);\n        this.execute();\n    }\n    /**\n     * Set the script on document.\n     */\n    setScript() {\n        if (document.getElementById(this.id)) {\n            // TODO wrap onerror callback for cases where the script was loaded elsewhere\n            this.callback();\n            return;\n        }\n        const url = this.createUrl();\n        const script = document.createElement(\"script\");\n        script.id = this.id;\n        script.type = \"text/javascript\";\n        script.src = url;\n        script.onerror = this.loadErrorCallback.bind(this);\n        script.defer = true;\n        script.async = true;\n        if (this.nonce) {\n            script.nonce = this.nonce;\n        }\n        document.head.appendChild(script);\n    }\n    /**\n     * Reset the loader state.\n     */\n    reset() {\n        this.deleteScript();\n        this.done = false;\n        this.loading = false;\n        this.errors = [];\n        this.onerrorEvent = null;\n    }\n    resetIfRetryingFailed() {\n        if (this.failed) {\n            this.reset();\n        }\n    }\n    loadErrorCallback(e) {\n        this.errors.push(e);\n        if (this.errors.length <= this.retries) {\n            const delay = this.errors.length * Math.pow(2, this.errors.length);\n            console.log(`Failed to load Google Maps script, retrying in ${delay} ms.`);\n            setTimeout(() => {\n                this.deleteScript();\n                this.setScript();\n            }, delay);\n        }\n        else {\n            this.onerrorEvent = e;\n            this.callback();\n        }\n    }\n    setCallback() {\n        window.__googleMapsCallback = this.callback.bind(this);\n    }\n    callback() {\n        this.done = true;\n        this.loading = false;\n        this.callbacks.forEach((cb) => {\n            cb(this.onerrorEvent);\n        });\n        this.callbacks = [];\n    }\n    execute() {\n        this.resetIfRetryingFailed();\n        if (this.done) {\n            this.callback();\n        }\n        else {\n            // short circuit and warn if google.maps is already loaded\n            if (window.google && window.google.maps && window.google.maps.version) {\n                console.warn(\"Google Maps already loaded outside @googlemaps/js-api-loader.\" +\n                    \"This may result in undesirable behavior as options and script parameters may not match.\");\n                this.callback();\n                return;\n            }\n            if (this.loading) ;\n            else {\n                this.loading = true;\n                this.setCallback();\n                this.setScript();\n            }\n        }\n    }\n}\n\nexport { DEFAULT_ID, Loader, LoaderStatus };\n//# sourceMappingURL=index.esm.js.map\n","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at.\n *\n *      Http://www.apache.org/licenses/LICENSE-2.0.\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport isEqual from \"fast-deep-equal\";\n\n/**\n * @ignore\n */\ndeclare global {\n  interface Window {\n    __googleMapsCallback: (e: Event) => void;\n  }\n}\n\nexport const DEFAULT_ID = \"__googleMapsScriptId\";\n\nexport type Libraries = (\n  | \"drawing\"\n  | \"geometry\"\n  | \"localContext\"\n  | \"marker\"\n  | \"places\"\n  | \"visualization\"\n)[];\n\n/**\n * The Google Maps JavaScript API\n * [documentation](https://developers.google.com/maps/documentation/javascript/tutorial)\n * is the authoritative source for [[LoaderOptions]].\n/**\n * Loader options\n */\nexport interface LoaderOptions {\n  /**\n   * See https://developers.google.com/maps/documentation/javascript/get-api-key.\n   */\n  apiKey: string;\n  /**\n   * @deprecated See https://developers.google.com/maps/premium/overview.\n   */\n  channel?: string;\n  /**\n   * @deprecated See https://developers.google.com/maps/premium/overview, use `apiKey` instead.\n   */\n  client?: string;\n  /**\n   * In your application you can specify release channels or version numbers:\n   *\n   * The weekly version is specified with `version=weekly`. This version is\n   * updated once per week, and is the most current.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: 'weekly'});\n   * ```\n   *\n   * The quarterly version is specified with `version=quarterly`. This version\n   * is updated once per quarter, and is the most predictable.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: 'quarterly'});\n   * ```\n   *\n   * The version number is specified with `version=n.nn`. You can choose\n   * `version=3.40`, `version=3.39`, or `version=3.38`. Version numbers are\n   * updated once per quarter.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: '3.40'});\n   * ```\n   *\n   * If you do not explicitly specify a version, you will receive the\n   * weekly version by default.\n   */\n  version?: string;\n  /**\n   * The id of the script tag. Before adding a new script, the Loader will check for an existing one.\n   */\n  id?: string;\n  /**\n   * When loading the Maps JavaScript API via the URL you may optionally load\n   * additional libraries through use of the libraries URL parameter. Libraries\n   * are modules of code that provide additional functionality to the main Maps\n   * JavaScript API but are not loaded unless you specifically request them.\n   *\n   * ```\n   * const loader = Loader({\n   *  apiKey,\n   *  libraries: ['drawing', 'geometry', 'places', 'visualization'],\n   * });\n   * ```\n   *\n   * Set the [list of libraries](https://developers.google.com/maps/documentation/javascript/libraries) for more options.\n   */\n  libraries?: Libraries;\n  /**\n   * By default, the Maps JavaScript API uses the user's preferred language\n   * setting as specified in the browser, when displaying textual information\n   * such as the names for controls, copyright notices, driving directions and\n   * labels on maps. In most cases, it's preferable to respect the browser\n   * setting. However, if you want the Maps JavaScript API to ignore the\n   * browser's language setting, you can force it to display information in a\n   * particular language when loading the Maps JavaScript API code.\n   *\n   * For example, the following example localizes the language to Japan:\n   *\n   * ```\n   * const loader = Loader({apiKey, language: 'ja', region: 'JP'});\n   * ```\n   *\n   * See the [list of supported\n   * languages](https://developers.google.com/maps/faq#languagesupport). Note\n   * that new languages are added often, so this list may not be exhaustive.\n   *\n   */\n  language?: string;\n  /**\n   * When you load the Maps JavaScript API from maps.googleapis.com it applies a\n   * default bias for application behavior towards the United States. If you\n   * want to alter your application to serve different map tiles or bias the\n   * application (such as biasing geocoding results towards the region), you can\n   * override this default behavior by adding a region parameter when loading\n   * the Maps JavaScript API code.\n   *\n   * The region parameter accepts Unicode region subtag identifiers which\n   * (generally) have a one-to-one mapping to country code Top-Level Domains\n   * (ccTLDs). Most Unicode region identifiers are identical to ISO 3166-1\n   * codes, with some notable exceptions. For example, Great Britain's ccTLD is\n   * \"uk\" (corresponding to the domain .co.uk) while its region identifier is\n   * \"GB.\"\n   *\n   * For example, the following example localizes the map to the United Kingdom:\n   *\n   * ```\n   * const loader = Loader({apiKey, region: 'GB'});\n   * ```\n   */\n  region?: string;\n  /**\n   * @deprecated Passing `mapIds` is no longer required in the script tag.\n   */\n  mapIds?: string[];\n  /**\n   * Use a custom url and path to load the Google Maps API script.\n   */\n  url?: string;\n  /**\n   * Use a cryptographic nonce attribute.\n   */\n  nonce?: string;\n  /**\n   * The number of script load retries.\n   */\n  retries?: number;\n  /**\n   * Maps JS customers can configure HTTP Referrer Restrictions in the Cloud\n   * Console to limit which URLs are allowed to use a particular API Key. By\n   * default, these restrictions can be configured to allow only certain paths\n   * to use an API Key. If any URL on the same domain or origin may use the API\n   * Key, you can set `auth_referrer_policy=origin` to limit the amount of data\n   * sent when authorizing requests from the Maps JavaScript API. This is\n   * available starting in version 3.46. When this parameter is specified and\n   * HTTP Referrer Restrictions are enabled on Cloud Console, Maps JavaScript\n   * API will only be able to load if there is an HTTP Referrer Restriction that\n   * matches the current website's domain without a path specified.\n   */\n  authReferrerPolicy?: \"origin\";\n}\n\n/**\n * The status of the [[Loader]].\n */\nexport enum LoaderStatus {\n  INITIALIZED,\n  LOADING,\n  SUCCESS,\n  FAILURE,\n}\n\n/**\n * [[Loader]] makes it easier to add Google Maps JavaScript API to your application\n * dynamically using\n * [Promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise).\n * It works by dynamically creating and appending a script node to the the\n * document head and wrapping the callback function so as to return a promise.\n *\n * ```\n * const loader = new Loader({\n *   apiKey: \"\",\n *   version: \"weekly\",\n *   libraries: [\"places\"]\n * });\n *\n * loader.load().then((google) => {\n *   const map = new google.maps.Map(...)\n * })\n * ```\n */\nexport class Loader {\n  private static instance: Loader;\n  /**\n   * See [[LoaderOptions.version]]\n   */\n  public readonly version: string;\n  /**\n   * See [[LoaderOptions.apiKey]]\n   */\n  public readonly apiKey: string;\n  /**\n   * See [[LoaderOptions.channel]]\n   */\n  public readonly channel: string;\n  /**\n   * See [[LoaderOptions.client]]\n   */\n  public readonly client: string;\n  /**\n   * See [[LoaderOptions.id]]\n   */\n  public readonly id: string;\n  /**\n   * See [[LoaderOptions.libraries]]\n   */\n  public readonly libraries: Libraries;\n  /**\n   * See [[LoaderOptions.language]]\n   */\n  public readonly language: string;\n\n  /**\n   * See [[LoaderOptions.region]]\n   */\n  public readonly region: string;\n\n  /**\n   * See [[LoaderOptions.mapIds]]\n   */\n  public readonly mapIds: string[];\n\n  /**\n   * See [[LoaderOptions.nonce]]\n   */\n  public readonly nonce: string | null;\n\n  /**\n   * See [[LoaderOptions.retries]]\n   */\n  public readonly retries: number;\n\n  /**\n   * See [[LoaderOptions.url]]\n   */\n  public readonly url: string;\n  /**\n   * See [[LoaderOptions.authReferrerPolicy]]\n   */\n  public readonly authReferrerPolicy: \"origin\";\n\n  private CALLBACK = \"__googleMapsCallback\";\n  private callbacks: ((e: ErrorEvent) => void)[] = [];\n  private done = false;\n  private loading = false;\n  private onerrorEvent: ErrorEvent;\n  private errors: ErrorEvent[] = [];\n\n  /**\n   * Creates an instance of Loader using [[LoaderOptions]]. No defaults are set\n   * using this library, instead the defaults are set by the Google Maps\n   * JavaScript API server.\n   *\n   * ```\n   * const loader = Loader({apiKey, version: 'weekly', libraries: ['places']});\n   * ```\n   */\n  constructor({\n    apiKey,\n    authReferrerPolicy,\n    channel,\n    client,\n    id = DEFAULT_ID,\n    language,\n    libraries = [],\n    mapIds,\n    nonce,\n    region,\n    retries = 3,\n    url = \"https://maps.googleapis.com/maps/api/js\",\n    version,\n  }: LoaderOptions) {\n    this.apiKey = apiKey;\n    this.authReferrerPolicy = authReferrerPolicy;\n    this.channel = channel;\n    this.client = client;\n    this.id = id || DEFAULT_ID; // Do not allow empty string\n    this.language = language;\n    this.libraries = libraries;\n    this.mapIds = mapIds;\n    this.nonce = nonce;\n    this.region = region;\n    this.retries = retries;\n    this.url = url;\n    this.version = version;\n\n    if (Loader.instance) {\n      if (!isEqual(this.options, Loader.instance.options)) {\n        throw new Error(\n          `Loader must not be called again with different options. ${JSON.stringify(\n            this.options\n          )} !== ${JSON.stringify(Loader.instance.options)}`\n        );\n      }\n\n      return Loader.instance;\n    }\n\n    Loader.instance = this;\n  }\n\n  public get options(): LoaderOptions {\n    return {\n      version: this.version,\n      apiKey: this.apiKey,\n      channel: this.channel,\n      client: this.client,\n      id: this.id,\n      libraries: this.libraries,\n      language: this.language,\n      region: this.region,\n      mapIds: this.mapIds,\n      nonce: this.nonce,\n      url: this.url,\n      authReferrerPolicy: this.authReferrerPolicy,\n    };\n  }\n\n  public get status(): LoaderStatus {\n    if (this.errors.length) {\n      return LoaderStatus.FAILURE;\n    }\n    if (this.done) {\n      return LoaderStatus.SUCCESS;\n    }\n    if (this.loading) {\n      return LoaderStatus.LOADING;\n    }\n    return LoaderStatus.INITIALIZED;\n  }\n\n  private get failed(): boolean {\n    return this.done && !this.loading && this.errors.length >= this.retries + 1;\n  }\n\n  /**\n   * CreateUrl returns the Google Maps JavaScript API script url given the [[LoaderOptions]].\n   *\n   * @ignore\n   */\n  public createUrl(): string {\n    let url = this.url;\n\n    url += `?callback=${this.CALLBACK}`;\n\n    if (this.apiKey) {\n      url += `&key=${this.apiKey}`;\n    }\n\n    if (this.channel) {\n      url += `&channel=${this.channel}`;\n    }\n\n    if (this.client) {\n      url += `&client=${this.client}`;\n    }\n\n    if (this.libraries.length > 0) {\n      url += `&libraries=${this.libraries.join(\",\")}`;\n    }\n\n    if (this.language) {\n      url += `&language=${this.language}`;\n    }\n\n    if (this.region) {\n      url += `&region=${this.region}`;\n    }\n\n    if (this.version) {\n      url += `&v=${this.version}`;\n    }\n\n    if (this.mapIds) {\n      url += `&map_ids=${this.mapIds.join(\",\")}`;\n    }\n\n    if (this.authReferrerPolicy) {\n      url += `&auth_referrer_policy=${this.authReferrerPolicy}`;\n    }\n\n    return url;\n  }\n\n  public deleteScript(): void {\n    const script = document.getElementById(this.id);\n    if (script) {\n      script.remove();\n    }\n  }\n\n  /**\n   * Load the Google Maps JavaScript API script and return a Promise.\n   */\n  public load(): Promise<typeof google> {\n    return this.loadPromise();\n  }\n\n  /**\n   * Load the Google Maps JavaScript API script and return a Promise.\n   *\n   * @ignore\n   */\n  public loadPromise(): Promise<typeof google> {\n    return new Promise((resolve, reject) => {\n      this.loadCallback((err: ErrorEvent) => {\n        if (!err) {\n          resolve(window.google);\n        } else {\n          reject(err.error);\n        }\n      });\n    });\n  }\n\n  /**\n   * Load the Google Maps JavaScript API script with a callback.\n   */\n  public loadCallback(fn: (e: ErrorEvent) => void): void {\n    this.callbacks.push(fn);\n    this.execute();\n  }\n\n  /**\n   * Set the script on document.\n   */\n  private setScript(): void {\n    if (document.getElementById(this.id)) {\n      // TODO wrap onerror callback for cases where the script was loaded elsewhere\n      this.callback();\n      return;\n    }\n\n    const url = this.createUrl();\n    const script = document.createElement(\"script\");\n    script.id = this.id;\n    script.type = \"text/javascript\";\n    script.src = url;\n    script.onerror = this.loadErrorCallback.bind(this);\n    script.defer = true;\n    script.async = true;\n\n    if (this.nonce) {\n      script.nonce = this.nonce;\n    }\n\n    document.head.appendChild(script);\n  }\n\n  /**\n   * Reset the loader state.\n   */\n  private reset(): void {\n    this.deleteScript();\n    this.done = false;\n    this.loading = false;\n    this.errors = [];\n    this.onerrorEvent = null;\n  }\n\n  private resetIfRetryingFailed(): void {\n    if (this.failed) {\n      this.reset();\n    }\n  }\n\n  private loadErrorCallback(e: ErrorEvent): void {\n    this.errors.push(e);\n\n    if (this.errors.length <= this.retries) {\n      const delay = this.errors.length * 2 ** this.errors.length;\n\n      console.log(\n        `Failed to load Google Maps script, retrying in ${delay} ms.`\n      );\n\n      setTimeout(() => {\n        this.deleteScript();\n        this.setScript();\n      }, delay);\n    } else {\n      this.onerrorEvent = e;\n      this.callback();\n    }\n  }\n\n  private setCallback(): void {\n    window.__googleMapsCallback = this.callback.bind(this);\n  }\n\n  private callback(): void {\n    this.done = true;\n    this.loading = false;\n\n    this.callbacks.forEach((cb) => {\n      cb(this.onerrorEvent);\n    });\n\n    this.callbacks = [];\n  }\n\n  private execute(): void {\n    this.resetIfRetryingFailed();\n\n    if (this.done) {\n      this.callback();\n    } else {\n      // short circuit and warn if google.maps is already loaded\n      if (window.google && window.google.maps && window.google.maps.version) {\n        console.warn(\n          \"Google Maps already loaded outside @googlemaps/js-api-loader.\" +\n            \"This may result in undesirable behavior as options and script parameters may not match.\"\n        );\n        this.callback();\n        return;\n      }\n\n      if (this.loading) {\n        // do nothing but wait\n      } else {\n        this.loading = true;\n        this.setCallback();\n        this.setScript();\n      }\n    }\n  }\n}\n"],"names":["isEqual"],"version":3,"file":"anycluster-google.js.map"}